// packages/core/src/plugins/rust.ts
import assert from "assert";
import fs from "fs/promises";
import path from "path";
var pkg = JSON.parse(await fs.readFile(path.join("pkg", "package.json"), "utf8"));
var glueName = pkg.files.find((file) => file.endsWith(".js"));
assert(glueName);
var glueCode = await fs.readFile(path.join("pkg", glueName), "utf8");
var code = await fs.readFile(path.join("worker", "worker.js"), "utf8");
var generatedDir = path.join("worker", "generated");
await fs.mkdir(generatedDir, { recursive: true });
await fs.writeFile(path.join(generatedDir, "script.js"), `${glueCode} ${code}`, "utf8");
var wasmName = pkg.files.find((file) => file.endsWith(".wasm"));
assert(wasmName);
await fs.copyFile(path.join("pkg", wasmName), path.join(generatedDir, "script.wasm"));
//# sourceMappingURL=rust.js.map
